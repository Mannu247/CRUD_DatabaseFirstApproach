
@{
    ViewBag.Title = "DatabaseIndex";
}

<h2 style="background-color:cornflowerblue;color:navy; font-family:'Times New Roman', Times, serif">DATABASE FIRST APPROACH</h2>
<br />
<table style="background-color: cornflowerblue; color: navy; font-family: 'Times New Roman', Times, serif">
    <tr>
        <td>Emp Name : </td>
        <td><input type="text" id="txtName" /></td>
    </tr>
    <tr>
        <td>Emp City : </td>
        <td><input type="text" id="txtCity" /></td>
    </tr>
    <tr>
        <td>Emp Mobile : </td>
        <td><input type="text" id="txtMobile" /></td>
    </tr>
    <tr>
        <td>Emp Age : </td>
        <td><input type="text" id="txtAge" /></td>
    </tr>
    <tr>
        <td></td>
        <td><input type="button" id="btnSub" value="SUBMIT" onclick="fun_sub()" /></td>
    </tr>
</table>
<br />
<table border="1" id="tblGv" style="background-color: cornflowerblue; color: navy; font-family: 'Times New Roman', Times, serif">
    <tr>
        <th>ID</th>
        <th>NAME</th>
        <th>CITY</th>
        <th>MOBILE</th>
        <th>AGE</th>
        <th></th>
        <th></th>
    </tr>
</table>
<script src="~/Scripts/jquery-3.4.1.min.js"></script>
<script type="text/javascript">
    var IDD = 0;
    $(document).ready(function () {
        fun_dis();
    });
    function fun_clear(){
        $("#txtName").val("");
        $("#txtCity").val("");
        $("#txtMobile").val("");
        $("#txtAge").val("");
        $("#btnSub").val("SUBMIT");
        IDD = 0;
    }
    function fun_sub() {
        $.ajax({
            url: 'Database/met_ins',
            type: 'post',
            data:
            {
                empid: IDD,
                name: $("#txtName").val(),
                city: $("#txtCity").val(),
                mobile: $("#txtMobile").val(),
                age: $("#txtAge").val()
            },
            success: function () {
                alert('Submitted!!');
                fun_dis();
                fun_clear();
            },
            error: function () {
                alert('Not Submitted!!');
            }
        });
    }
    function fun_dis() {
        $.ajax({
            url: 'Database/met_dis',
            type: 'post',
            data: {},
            success: function (data) {
                $("#tblGv").find("tr:gt(0)").remove();
                for (var i = 0; i < data.length; i++) {
                    $("#tblGv").append('<tr> <td>' + data[i].empid + '</td> <td>' + data[i].name + '</td> <td>' + data[i].city + '</td> <td>' + data[i].mobile + '</td> <td>' + data[i].age + '</td> <td style="color:navy"><input type="button" id="btnDlt" value="DELETE" onclick="fun_dlt(' + data[i].empid + ')" </td> <td style="color:navy"><input type="button" id="btnEdt" value="EDIT" onclick="fun_edt(' + data[i].empid +')" </td> </tr>')
                }
            },
            error: function () {
                alert('Data not found!!');
            }
        });
    }
    function fun_dlt(empid) {
        if (confirm('are you sure you want to deleted??')){
            $.ajax({
                url: 'Database/met_dlt',
                type: 'post',
                data:
                {
                    A: empid
                },
                success: function () {
                    alert('Deleted!!');
                    fun_dis();
                },
                error: function () {
                    alert('Not Deleted!!!!');
                }
            });
        }
    }
    function fun_edt(empid) {
        $.ajax({
            url: 'Database/met_edt',
            type: 'post',
            data: {A: empid},
            success: function (data) {
                for (var i = 0; i < data.length; i++) {
                    $("#txtName").val(data[0].name);
                    $("#txtCity").val(data[0].city);
                    $("#txtMobile").val(data[0].mobile);
                    $("#txtAge").val(data[0].age);
                    $("#btnSub").val("UPDATE");
                    IDD = empid;
                }
            },
            error: function () {
                alert('Not Edited!!');
            }
        });
    }
</script>
